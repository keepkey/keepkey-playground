const { KeepKeySdk } = require("@keepkey/keepkey-sdk")

let spec = 'http://localhost:1646/spec/swagger.json'

let run_test = async function () {
    try {
        let config = {
            apiKey: process.env['SERVICE_KEY'] || '1fa0c776-eaa9-499d-a2e5-f76af6073912',
            pairingInfo:{
                name: process.env['SERVICE_NAME'] || 'KeepKey SDK Demo App',
                imageUrl: process.env['SERVICE_IMAGE_URL'] || 'https://github.com/BitHighlander/keepkey-desktop/raw/master/electron/icon.png',
                basePath:spec,
                url:"http://localhost:1646"
            }
        }
        //init
        const sdk = await KeepKeySdk.create(config)
        console.log("newKey: ",config.apiKey)

        let input = {
            "addressNList": [
                2147483692,
                2147483708,
                2147483649,
                0,
                0
            ],
            "chainId": "0x1",
            "data": "0x9508b1c40000000000000000000000000000000000000000000000000000000000000080ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a50000000000000000000000000000000000000000000000000000000000000d400000000000000000000000000000000000000000000000000000000000000f800000000000000000000000000000000000000000000000000000000000000c9ff90c9c841d454940b9012043a2a97d53bd42fbf5a34471e7a6363b76f9b8980231a4cffaa20c74d682c40a30f730bbc2201a8b8419f5def766eff3613b4185c81a6ad6413e97762bd25c216f9390e2c8a4f4bfdbbb9728e31ce2327cae2fb9e5b210d889abc266757c91119fd9fcb95edf57578a5beb1b36f0de9061e7fbf88e942098d146c2247a367f92916672be0985b6809524aaade01cc252c9b986390cb7ee1341b412545322d0f908874215c70004eed4d8c1a911d52f47a1cb37d32d99bf3bd54904f79841a42b4faf6933468996f842d83c55c248d68e309640c253f2e35c2cf23745fa80dd28d8a504cfe4d5b87386e3273da5893ec5a444ef80097c2d92ebbb60e82c5a58cc8aa3661768eaa649781b0381f4f311993ef587bdf3337725fc61707744203d698402bbfcc28464cc1feaa0f8a2fcc5158a085341facd13095fa68eeff262f6ccbdce9fe5674a1194c72e7fa043284467756e867323024046337092afc5dffa8076c1b24ea431f909f70f8afbb903e6f903e3018344a005b9010000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000020040008000000000000000000000200000000000000000000000000028000000800000000000400000000100080000000000100000020000000000000000000800000000000000000080100010000000000000000000000000002000000000000000000000004000000000000000000000220000000000080000020000000000000000000000000000000000000000004000000002000000000001000000000000010000008000000000100000000020000010000000000000000810000000001000000000000000000000000000100000f902d8f85a94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff842a0185c30856dadb58bf097c1f665a52ada7029752dbcad008ea3fefc73bee8c9fea0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f89c94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff884a08c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925a00000000000000000000000008c9ed98b7c3961d22cc871356c7b73d194608817a00000000000000000000000000000000000000000000000000000000000000000a0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f89c94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000008c9ed98b7c3961d22cc871356c7b73d194608817a00000000000000000000000000000000000000000000000000000000000000000a0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000a84ac5ea976711d64807590351c549918c711b21a00000000000000000000000007c7379531b2aee82e4ca06d4175d13b9cbeafd49b8a0000000000000000000000000000000000000000000000000000a915ce2bf4539000000000000000000000000000000000000000000000000665e9fb109afe00000000000000000000000000000000000000000000002414700b2bbd76692515c00000000000000000000000000000000000000000000000066540e5426f09ac700000000000000000000000000000000000000000002414700bd4d3449519695b90738f90735f90131a00e6cecddc2d09751b4e6eebcb75572303781fd1b6e2da50325f3c04ff67ea2f6a0cdf1fdfb510280b21a9517f64ab40e65831b30ba35ec7fb4ae28bddd92e7b87da06754e4931b3cf7e8c692f0fadcf5c588fe1ea33e5cb0e7f7a311e0e4003e0320a04f9ab151986186f930b35b901abac67c0c6f4caa7ad74da284d961838d8bf09aa0af0df1cc71ed4d7ae186f81f654399b83a26f0fb28f3d45d287f741b08308e24a05763a6246e74ad241ec5a3facbf51483122d3c0da7157fa79b51c7616c068089a04ee60da031662071effd31b33667272736aeea6a68f1fc974d869edd6e539ab5a0380f49d280700ba3e4c0485936bdc71f0e0581f2c9e3fc54a3d6e0e1e92cf711a0b0f59d24b996f2df3b06c3da26ff900accbc0f02f3b0e7249ee389b75205ac038080808080808080f90211a02a2604bac16c7e13617f3efccc9ef584ccdd3fdce8463c287d4fbd4f397d297ea0efb5ed29296bfa48437578c4a358306cfa7f76af1465afd0ef384240560a2f7ea02cd1e17f7a8c285c56887fc22fb3d12581fcfee98128c22b136a7e4bf0317a22a0c448dca20f398e357f798fd1fe38e68d69739d5409f61e472a999032494f54f7a033eb9cbe5f62b69c51aa5815474d95520582bb52ed8191500d35c51278f540c6a0086188ca974d39de67e8b2c77c0079bc6d9a2b838b33aec9238c14e5f46f8e08a03bc9f8211e1b5485a726b6b99cc8e5465c0f597f93f04cc93e26b9a759837be2a0528715ad0e7b014b2e30cef7016a4d67ea22f03486639bac3595afd68a29af8ea0d4671d2b58d20f7d1eb842f11e923cce43b9446172244576195908a6018ca33ca03b35732678d2c4cdf54eca92d2c1e90b1ae141e80c5e669a2503bb4062af1b87a045e6d575829d9fe3724bc0d7a0e871098268e7ea975634ba60da1c354aff02d1a018304c45d31cc275da59bb0a2911b3e15767dccf9c393b072100705f9931fa0ca04689a1c6453b4c10922866be7e73195a2af1f832189f2c95a94268c0f30265aca0bdae15bd63d9521f4e0e7c504bec09dc77315c910720684a96def01386cfdf58a0c6f1dabc18129ee2bf690719ca363c633f874e558d4af324b82ba165b3869b2fa00c24aa758c7fcc23686798f6e82a85d8c61afe30673a237713151107bbd5f7cc80f903ea20b903e6f903e3018344a005b9010000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000020040008000000000000000000000200000000000000000000000000028000000800000000000400000000100080000000000100000020000000000000000000800000000000000000080100010000000000000000000000000002000000000000000000000004000000000000000000000220000000000080000020000000000000000000000000000000000000000004000000002000000000001000000000000010000008000000000100000000020000010000000000000000810000000001000000000000000000000000000100000f902d8f85a94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff842a0185c30856dadb58bf097c1f665a52ada7029752dbcad008ea3fefc73bee8c9fea0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f89c94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff884a08c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925a00000000000000000000000008c9ed98b7c3961d22cc871356c7b73d194608817a00000000000000000000000000000000000000000000000000000000000000000a0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f89c94a9a6a3626993d487d2dbda3173cf58ca1a9d9e9ff884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000008c9ed98b7c3961d22cc871356c7b73d194608817a00000000000000000000000000000000000000000000000000000000000000000a0ab2922a033e396e81d5935d8d8faa2059662eb00149169ab5292ea65af9841a580f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000a84ac5ea976711d64807590351c549918c711b21a00000000000000000000000007c7379531b2aee82e4ca06d4175d13b9cbeafd49b8a0000000000000000000000000000000000000000000000000000a915ce2bf4539000000000000000000000000000000000000000000000000665e9fb109afe00000000000000000000000000000000000000000000002414700b2bbd76692515c00000000000000000000000000000000000000000000000066540e5426f09ac700000000000000000000000000000000000000000002414700bd4d34495196958200210200000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000001177686f69732e656d61696c2e76616c7565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001263727970746f2e4554482e616464726573730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001477686f69732e666f725f73616c652e76616c7565000000000000000000000000000000000000000000000000000000000000000000000000000000000000002263727970746f2e4d415449432e76657273696f6e2e45524332302e61646472657373000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002263727970746f2e4d415449432e76657273696f6e2e4d415449432e61646472657373000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000000166d2e6861727269733832313440676d61696c2e636f6d00000000000000000000000000000000000000000000000000000000000000000000000000000000002a3078386339656439386237633339363164323263633837313335366337623733643139343630383831370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000047472756500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783863396564393862376333393631643232636338373133353663376237336431393436303838313700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783863396564393862376333393631643232636338373133353663376237336431393436303838313700000000000000000000000000000000000000000000",
            "gasLimit": "0x2acc0",
            "to": "0x049aba7510f45ba5b64ea9e658e342f904db358d",
            "value": "0x0",
            "nonce": "0x22"
        }

        let responseSign = await sdk.eth.ethSignTransaction(input)
        console.log("responseSign: ", responseSign.data)
        console.log("responseSign: ", responseSign.data.signedTx)
        console.log("responseSign: ", JSON.stringify(responseSign))

    } catch (e) {
        console.error(e)
        console.log("e: ", Object.keys(e))
        console.log("e: ", e.response)
        // console.log("e: ", Object.keys(e.name.toString()))
        // console.log("e: ", Object.keys(e.response.toString()))
        // console.log("e: ", e.response)

        console.log("e: ", e.response.toString())
    }
}

run_test()
